<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <title>Introdução à Computação Gráfica</title>
    </head>
    <style>
        body {
            text-align: center;
            font-size: 48px;  
            background-color: black;
        }
    </style>
    <body>
        <header style="color: white;">Introdução à Computação Gráfica </header>
        
        <canvas id="canvas" width="128" height="128" style="border: 1px solid white; width: 512px; height: 512px; image-rendering: pixelated; top:20px; left: 16px; margin-top: 50px;"></canvas>
        <script>
            class Canvas {
                constructor(canvas_id) {
                    this.canvas = document.getElementById(canvas_id);
                    this.context = this.canvas.getContext("2d");
                    this.clear_color = 'rgba(0,0,0,255)';
                }

                clear() {
                    this.context.fillStyle = this.clear_color;
                    this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
                }

                putPixel(x, y, color) {
                    this.context.fillStyle = 'rgb(' + color[0] + ',' + color[1] + ',' + color[2] + ')';
                    this.context.fillRect(x, (this.canvas.height - 1) - y, 1, 1);
                }
            }      

            let color_buffer = new Canvas("canvas");
            color_buffer.clear();

            function MidPointLineAlgorithm(xi, yi, xf, yf, color_0, color_1) {
                console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)

                //centralizando
                xi = xi+64
                xf = xf+64
                yi = yi+64
                yf = yf+64
                console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)
                let printaEmRelacaoAY = false;
                let printaNegativo = false;

                // Variáveis iniciais 1° octante
                let dx = xf - xi; 
                let dy = yf - yi; 
                console.log(`dx: ${dx}, dy: ${dy}`)
                console.log(`m = ${dy/dx}`)
                //avaliar se pode manter essa divisão
                let m = (dy/dx);

                // Avaliação de condições

                if (0 <= m && m <= 1){ //1 e 5 octante
                    //para o primeiro não precisa fazer nada
                    // 5° octante
                    if(xf < xi){
                        //inverte x
                        let aux;
                        aux = xi;
                        xi = xf;
                        xf = aux;
                        //inverte y
                        aux = yi;
                        yi = yf;
                        yf = aux;

                        dx = dx * (-1); 
                        dy = dy * (-1);
                        console.log("inverteu")
                        console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)
                        console.log(`dx: ${dx}, dy: ${dy}`)

                    }
                }
                if(m > 1){ //2 e 6 octante
                    printaEmRelacaoAY = true;
                    
                    
                    // troca os valores de dy e dx
                    let aux;
                    aux = dx;
                    dx = dy;
                    dy = aux;
                    console.log(`dx: ${dx}, dy: ${dy}`)

                    // troca os valores de xi e yi
                    let aux1;
                    aux1 = xi;
                    xi = yi;
                    yi = aux1;
                    // troca de valores de xf e yf
                    let aux2;
                    aux2 = xf;
                    xf = yf;
                    yf = aux2;
                    console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)
                    
                    if(yf < yi){
                        console.log("inverteu")
                        //inverte x
                        let aux;
                        aux = xi;
                        xi = xf;
                        xf = aux;
                        //inverte y
                        aux = yi;
                        yi = yf;
                        yf = aux;

                        dx = dx * (-1); 
                        dy = dy * (-1);
                        console.log(`dx: ${dx}, dy: ${dy}`)
                        console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)
                    }
                }

                if (m < -1){ //3 e 7 octantes
                    console.log("3 e 7 octantes")
                    printaEmRelacaoAY = true;
                    printaNegativo = true;

                    // troca os valores de dy e dx
                    let aux;
                    aux = dx;
                    dx = dy;
                    dy = aux;
                   
                    // troca de valores de xf e yf
                    let aux2;
                    aux2 = xf;
                    xf = yf;
                    yf = aux2;

                    // inverte dy
                    dy = dy * (-1);

                    console.log(`xi: ${xi}, xf: ${xf}, yi: ${yi}, yf: ${yf}`)
                
                    console.log(`dx: ${dx}, dy: ${dy}`)
                    
                    if(yf > yi){
                        console.log("inverteu")
                        let aux;
                        aux = xi;
                        xi = xf;
                        xf = aux;
                        //inverte y
                        aux = yi;
                        yi = yf;
                        yf = aux;

                        dy = dy * (-1);
                        dx = dx * (-1); 

                    }
                }

                // Coeficientes
                
                let d = 2 * dy - dx; 
                let incrE = 2 * dy; 
                let incrNE = 2 * (dy - dx); 
                 
                printaEmRelacaoAY ? color_buffer.putPixel(yi, xi, color_0) : color_buffer.putPixel(xi, yi, color_0);
            
                while (xi<xf) { 
                    console.log(`d=${d}`)
                    if (d<=0) { 
                        d += incrE; 
                        xi++;
                        console.log('leste');
                    } else { 
                        d += incrNE; 
                        xi++;
                        printaNegativo ? yi-- : yi++;
                        console.log('nordeste');

                    } 
                    printaEmRelacaoAY ? color_buffer.putPixel(yi, xi, color_0) : color_buffer.putPixel(xi, yi, color_0);
                    console.log(`xi: ${xi}, yi: ${yi}`)

                }
            }

            // //1 octante
            // MidPointLineAlgorithm(0, 0, 20, 10, [255,255,0,255]);
            // MidPointLineAlgorithm(0, 0, 20, 0, [255,255,0,255]);
            // MidPointLineAlgorithm(0, 0, 20, 20, [255,255,0,255]);
            //2 octante
            MidPointLineAlgorithm(0, 0, 10, 20, [255,0,0,255]);
            //MidPointLineAlgorithm(0, 0, 0, 20, [255,0,0,255]);

            //3 octante
            MidPointLineAlgorithm(0, 0, -10 , 20, [120,120,255,255])
            //MidPointLineAlgorithm(0, 0, 0 , 20, [120,120,255,255])



            // //5 octante
            // MidPointLineAlgorithm(0, 0, -20, -10, [255,0,255,255]);
            // MidPointLineAlgorithm(0, 0, -20, 0, [255,0,255,255]);
            // MidPointLineAlgorithm(0, 0, -20, -20, [255,0,255,255]);

            // //6 octante
            MidPointLineAlgorithm(0, 0, -10, -20, [255,255,255,255]);
            //MidPointLineAlgorithm(0, 0, -20, -20, [255,255,158,255]);

            // 7 octante
           //MidPointLineAlgorithm(0, 0, 19 , -20, [255,0,255,255])
            MidPointLineAlgorithm(0, 0, 10 , -20, [255,0,255,255])
       



           // MidPointLineAlgorithm(0, 0, 15 , 13, [255,0,255,255]);
           // MidPointLineAlgorithm(0, 0,  5, 7, [255,0,0,255]);
           //MidPointLineAlgorithm(0, 0, -10 , 13, [255,0,255,255])





        </script>
    </body>
</html>